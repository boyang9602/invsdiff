package ca.concordia.apr.invsdiff;

import java.io.FileNotFoundException;
import java.io.IOException;

/**
 * Compare similar invariants file generated by daikon, i.e. invariants of slightly different versions
 *
 */
public class App 
{
    public static void main( String[] args ) throws FileNotFoundException, IOException
    {
    	if (args.length < 2) {
    		System.out.println("Usage: \n - ca.concordia.apr.invsdiff.App [options] invsfile0 invsfile1 invsfile2 ... \n - options: \n\t --format=[format] output file format. json or txt. default is json");
    		System.exit(1);
    	}
    	int i = 0;
    	String outputFormat = ".json";
    	if (args[i].startsWith("--format=")) {
    		String format = args[i].substring(args[i].indexOf("=") + 1);
    		if (format.equals("txt")) {
    			outputFormat = ".txt";
    		}
    		i++;
    	}
    	InvsFile base = new InvsFile(args[i++]);
        for (int j = 0; i < args.length; i++, j++) {
        	InvsFile toBeCompared = new InvsFile(args[i]);
        	Diff diff = Diff.compare(base, toBeCompared);
        	if (outputFormat.equals(".txt")) {
            	diff.writeTxtTo("diff" + (j + 1) + ".txt");
        	} else {
        		diff.writeJSONTo("diff" + (j + 1) + ".json");
        	}
        }
    }
}
